---
steps:
  - name: gcr.io/cloud-builders/gsutil
    dir: './${_FOLDER}/'
    args: ['cp', 'gs://${_PLAN_BUCKET}/variables/test-environment-variables.auto.tfvars', '.']
    waitFor: ['-']
  - name: gcr.io/cloud-builders/gsutil
    dir: './${_FOLDER}/'
    args: ['cp', 'gs://${_PLAN_BUCKET}/backend/backend.tf', '.']
    waitFor: ['-']
  - name: hashicorp/terraform
    dir: './${_FOLDER}/'
    args:
      - init
  - name: hashicorp/terraform
    dir: './${_FOLDER}/'
    args:
      - apply
      - -auto-approve
tags:
  - 'pull-apply'
timeout: 7200s